C51 COMPILER V7.06   99秒                                                                  05/13/2009 13:26:55 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE 99秒
OBJECT MODULE PLACED IN 99秒.OBJ
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE 99秒.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          /*-----------------------------------------------
   2            名称：99秒计时器
   3            公司：上海浩豚电子科技有限公司
   4            网站：www.doflye.cn
   5            编写：师访
   6            日期：2009.5
   7            修改：无
   8            内容：通过定时器计时
   9          ------------------------------------------------*/
  10          #include<reg52.h>     //包含头文件，一般情况不需要改动，头文件包含特殊功能寄存器的定义
  11          code unsigned char tab[]=
  12                                  {0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f}; 
  13                                            //共阴数码管 0-9 
  14          
  15          unsigned char Dis_Shiwei;//定义十位
  16          unsigned char Dis_Gewei; //定义个位
  17          /******************************************************************/
  18          /*                    延时函数                                    */
  19          /******************************************************************/
  20          void delay(unsigned int cnt)
  21          {
  22   1       while(--cnt);
  23   1      }
  24          /******************************************************************/
  25          /*                    主函数                                      */
  26          /******************************************************************/
  27          main()
  28          {
  29   1      
  30   1      TMOD |=0x01;//定时器设置 10ms in 12M crystal，工作在模式1，16位定时
  31   1      TH0=0xd8;
  32   1      TL0=0xf0;
  33   1      IE= 0x82;  //打开中断
  34   1      TR0=1;     //打开定时开关
  35   1      
  36   1      while(1)
  37   1        {
  38   2        P0=Dis_Shiwei;//显示十位
  39   2        P2=0;
  40   2        delay(300);   //短暂延时
  41   2        P0=Dis_Gewei; //显示个位
  42   2        P2=1;
  43   2        delay(300);
  44   2        }
  45   1      
  46   1      }
  47          /******************************************************************/
  48          /*                    定时器中断函数                              */
  49          /******************************************************************/
  50          void tim(void) interrupt 1 using 1
  51          {
  52   1      static unsigned char second,count;
  53   1      TH0=0xd8;             //重新赋值
  54   1      TL0=0xf0;
  55   1      
C51 COMPILER V7.06   99秒                                                                  05/13/2009 13:26:55 PAGE 2   

  56   1      count++;             
  57   1      if (count==100)       //100x10ms=1S，大致延时时间
  58   1          {
  59   2          count=0;
  60   2          second++;         //秒加1
  61   2              if(second==100)
  62   2                 second=0;
  63   2              Dis_Shiwei=tab[second/10];//十位显示值处理
  64   2          Dis_Gewei=tab[second%10]; //个位显示处理
  65   2          
  66   2              }
  67   1      
  68   1      
  69   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    122    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
