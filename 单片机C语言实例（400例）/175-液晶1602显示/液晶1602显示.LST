C51 COMPILER V7.50   _º_§1602ÏÔÊ_                                                          09/11/2011 16:47:56 PAGE 1   


C51 COMPILER V7.50, COMPILATION OF MODULE _º_§1602ÏÔÊ_
OBJECT MODULE PLACED IN Òº¾§1602ÏÔÊ¾.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Òº¾§1602ÏÔÊ¾.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /********************************************************************
   2          * ÎÄ¼þÃû  £º Òº¾§1602ÏÔÊ¾.c
   3          * ÃèÊö    :  ¸Ã³ÌÐòÊµÏÖÁË¶ÔÒº¾§1602µÄ¿ØÖÆ¡£
   4          * ´´½¨ÈË  £º ¶«Á÷£¬2009Äê4ÔÂ10ÈÕ
   5          * °æ±¾ºÅ  £º 2.0
   6          ***********************************************************************/
   7          #include<reg52.h>
   8          #include<intrins.h>
   9          #define uchar unsigned char
  10          #define uint  unsigned int
  11          
  12          //ÕâÈý¸öÒý½Å²Î¿¼×ÊÁÏ
  13          sbit E=P2^7;            //1602Ê¹ÄÜÒý½Å
  14          sbit RW=P2^6;           //1602¶ÁÐ´Òý½Å  
  15          sbit RS=P2^5;           //1602Êý¾Ý/ÃüÁîÑ¡ÔñÒý½Å
  16          
  17          
  18          /********************************************************************
  19          * Ãû³Æ : delay()
  20          * ¹¦ÄÜ : ÑÓÊ±,ÑÓÊ±Ê±¼ä´ó¸ÅÎª5US¡£
  21          * ÊäÈë : ÎÞ
  22          * Êä³ö : ÎÞ
  23          ***********************************************************************/
  24          
  25          void delay()
  26          {
  27   1              _nop_();
  28   1              _nop_();
  29   1              _nop_();
  30   1              _nop_();
  31   1              _nop_();
  32   1      }
  33          /********************************************************************
  34          * Ãû³Æ : bit Busy(void)
  35          * ¹¦ÄÜ : Õâ¸öÊÇÒ»¸ö¶Á×´Ì¬º¯Êý£¬¶Á³öº¯ÊýÊÇ·ñ´¦ÔÚÃ¦×´Ì¬
  36          * ÊäÈë : ÊäÈëµÄÃüÁîÖµ
  37          * Êä³ö : ÎÞ
  38          ***********************************************************************/
  39          bit Busy(void)
  40          {
  41   1              bit busy_flag = 0;
  42   1              RS = 0;
  43   1              RW = 1;
  44   1              E = 1;
  45   1              delay();
  46   1              busy_flag = (bit)(P0 & 0x80);
  47   1              E = 0;
  48   1              return busy_flag;
  49   1      }
  50          /********************************************************************
  51          * Ãû³Æ : wcmd(uchar del)
  52          * ¹¦ÄÜ : 1602ÃüÁîº¯Êý
  53          * ÊäÈë : ÊäÈëµÄÃüÁîÖµ
  54          * Êä³ö : ÎÞ
  55          ***********************************************************************/
C51 COMPILER V7.50   _º_§1602ÏÔÊ_                                                          09/11/2011 16:47:56 PAGE 2   

  56          void wcmd(uchar del)
  57          {
  58   1              while(Busy());
  59   1              RS = 0;
  60   1              RW = 0;
  61   1              E = 0;
  62   1              delay();
  63   1              P0 = del;
  64   1              delay();
  65   1              E = 1;
  66   1              delay();
  67   1              E = 0;
  68   1      }
  69          
  70          /********************************************************************
  71          * Ãû³Æ : wdata(uchar del)
  72          * ¹¦ÄÜ : 1602Ð´Êý¾Ýº¯Êý
  73          * ÊäÈë : ÐèÒªÐ´Èë1602µÄÊý¾Ý
  74          * Êä³ö : ÎÞ
  75          ***********************************************************************/
  76          
  77          void wdata(uchar del)
  78          {
  79   1              while(Busy());
  80   1              RS = 1;
  81   1              RW = 0;
  82   1              E = 0;
  83   1              delay();
  84   1              P0 = del;
  85   1          delay();
  86   1              E = 1;
  87   1              delay();
  88   1              E = 0;
  89   1      }
  90          
  91          /********************************************************************
  92          * Ãû³Æ : L1602_init()
  93          * ¹¦ÄÜ : 1602³õÊ¼»¯£¬Çë²Î¿¼1602µÄ×ÊÁÏ
  94          * ÊäÈë : ÎÞ
  95          * Êä³ö : ÎÞ
  96          ***********************************************************************/
  97          void L1602_init(void)
  98          {
  99   1              wcmd(0x38);
 100   1              wcmd(0x0c);
 101   1              wcmd(0x06);
 102   1              wcmd(0x01);
 103   1      }
 104          
 105          /********************************************************************
 106          * Ãû³Æ : L1602_char(uchar hang,uchar lie,char sign)
 107          * ¹¦ÄÜ : ¸Ä±äÒº¾§ÖÐÄ³Î»µÄÖµ£¬Èç¹ûÒªÈÃµÚÒ»ÐÐ£¬µÚÎå¸ö×Ö·ûÏÔÊ¾"b" £¬µ÷ÓÃ¸Ãº¯ÊýÈçÏÂ
 108                           L1602_char(1,5,'b')
 109          * ÊäÈë : ÐÐ£¬ÁÐ£¬ÐèÒªÊäÈë1602µÄÊý¾Ý
 110          * Êä³ö : ÎÞ
 111          ***********************************************************************/
 112          void L1602_char(uchar hang,uchar lie,char sign)
 113          {
 114   1              uchar a;
 115   1              if(hang == 1) a = 0x80;
 116   1              if(hang == 2) a = 0xc0;
 117   1              a = a + lie - 1;
C51 COMPILER V7.50   _º_§1602ÏÔÊ_                                                          09/11/2011 16:47:56 PAGE 3   

 118   1              wcmd(a);
 119   1              wdata(sign);
 120   1      }
 121          
 122          /********************************************************************
 123          * Ãû³Æ : L1602_string(uchar hang,uchar lie,uchar *p)
 124          * ¹¦ÄÜ : ¸Ä±äÒº¾§ÖÐÄ³Î»µÄÖµ£¬Èç¹ûÒªÈÃµÚÒ»ÐÐ£¬µÚÎå¸ö×Ö·û¿ªÊ¼ÏÔÊ¾"ab cd ef" £¬µ÷ÓÃ¸Ãº¯ÊýÈçÏÂ
 125                           L1602_string(1,5,"ab cd ef;")
 126          * ÊäÈë : ÐÐ£¬ÁÐ£¬ÐèÒªÊäÈë1602µÄÊý¾Ý
 127          * Êä³ö : ÎÞ
 128          ***********************************************************************/
 129          void L1602_string(uchar hang,uchar lie,uchar *p)
 130          {
 131   1              uchar a,b=0;
 132   1              if(hang == 1) a = 0x80;
 133   1              if(hang == 2) a = 0xc0;
 134   1              a = a + lie - 1;
 135   1              while(1)
 136   1              {
 137   2                      wcmd(a++);
 138   2                      b++;
 139   2                      if((*p == '\0')||(b==16)) break;
 140   2                      wdata(*p);
 141   2                      p++;
 142   2              }
 143   1      }
 144          
 145          /********************************************************************
 146          * Ãû³Æ : Main()
 147          * ¹¦ÄÜ : Ö÷º¯Êý
 148          * ÊäÈë : ÎÞ
 149          * Êä³ö : ÎÞ
 150          ***********************************************************************/
 151          void Main()
 152          {
 153   1              L1602_init();
 154   1              L1602_string(1,1,"   0123456789   ");
 155   1              L1602_string(2,1,"   ABCDEFGHIJ   ");
 156   1              L1602_char(2,15,'O');
 157   1              L1602_char(2,16,'K');
 158   1              while(1);       
 159   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    203    ----
   CONSTANT SIZE    =     34    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
